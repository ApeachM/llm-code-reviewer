# Few-shot learning with 3 examples
# Research hypothesis: +30-40% accuracy improvement over zero-shot

experiment_id: few_shot_3_examples
technique_name: few_shot_3
model_name: deepseek-coder:33b-instruct
dataset_path: experiments/ground_truth/cpp

technique_params:
  system_prompt: |
    You are an expert C++ code reviewer. Analyze code for issues in these categories:
    memory-safety, modern-cpp, performance, security, concurrency

    Respond with JSON array of issues. Each issue: {category, severity, line, description, reasoning}
    If no issues, respond with [].

  # Few-shot examples (high-quality annotated examples)
  few_shot_examples:
    - id: example_001
      description: "Memory leak example"
      code: |
        int* ptr = new int(10);
        *ptr = 42;
        std::cout << *ptr << std::endl;
        return 0;
        // missing: delete ptr;
      issues:
        - category: memory-safety
          severity: critical
          line: 1
          description: "Memory leak - dynamically allocated pointer never deleted"
          reasoning: "Pointer allocated with 'new' on line 1 but there is no corresponding 'delete' statement. This causes a memory leak on every execution."

    - id: example_017
      description: "Clean code - no issues"
      code: |
        #include <memory>
        std::unique_ptr<int> ptr = std::make_unique<int>(42);
        std::cout << *ptr << std::endl;
        return 0;
      issues: []

    - id: example_015
      description: "Data race example"
      code: |
        #include <thread>
        int counter = 0;
        void incrementCounter() {
            for (int i = 0; i < 1000; i++) {
                counter++;  // data race!
            }
        }
        std::thread t1(incrementCounter);
        std::thread t2(incrementCounter);
        t1.join();
        t2.join();
      issues:
        - category: concurrency
          severity: critical
          line: 4
          description: "Data race - unsynchronized access to shared variable 'counter'"
          reasoning: "Variable 'counter' is accessed by multiple threads without synchronization. The increment operation is not atomic. Use std::mutex or std::atomic<int>."

  temperature: 0.1
  max_tokens: 2000

seed: 42
